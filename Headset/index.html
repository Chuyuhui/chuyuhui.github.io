<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <title>TTT</title>
    <meta name="generator" content="Google Web Designer 8.0.3.0603">
    <script integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
    <style type="text/css" id="gwd-text-style">

    </style>
    <style type="text/css">
      html, body {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        font-size: 1em;  /*用vw的話就算放大也不會改變。 差不多1~1.5vw。但用vw的話其他單位也要一起改才不會亂掉。*/
        font-family: "Microsoft JhengHei";
      }
      body {
        background-color: transparent;
        transform: perspective(1400px) matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
        transform-style: preserve-3d;
        text-align: center;
        font-family: "Microsoft JhengHei";
        overflow-x:hidden;
      }
      p {
        margin: 0px;
      }
      h1 {
        margin: 0px;
        padding: 1rem;
      }
      h2 {
        margin: 0px;
      }
      h3 {
        margin: 0px;
      }
      input[type="button"] {
        margin: 0px;
        font-size: 1rem;
        font-family: "Microsoft JhengHei";
      }
      input[type="submit"] {
        margin: 0px;
        font-size: 1rem;
        font-family: "Microsoft JhengHei";
      }
      button {
        margin: 1rem auto;
        font-size: 1rem;
        font-family: "Microsoft JhengHei";
        padding: 1rem;
      }

      .explanation {
        width: 100%;
        height: auto;
        text-align: center;
        vertical-align: middle;
        background: rgb(204, 204, 204);
      }
      .example {
        width: 23rem !important;
      }

      div {
        margin: 0px auto;
      }
      .ADJ_Word{
        height: 1.5rem;
        width: 8rem;
        display: table-cell;
        vertical-align: middle; 
        font-weight: bold;
        padding:0;
      }

    </style>

    <style type="text/css" id="css_Slider">
      .custom-handle {
        width: 1.5rem;
        height: 1.5rem;
        text-align: center;
        line-height: 1.5rem;
        top:-0.625rem;
        background-image: url("https://imgur.com/06zVfHc.png");
        background-size: cover;
        border: 0px black solid;
        outline:none;
        cursor:pointer;
      }
      .slider{
        background: #ccc;
        border: 0px black solid;
        width: 36rem;
        top:0rem;
        height:0.25rem;
        line-height: 1.5rem;
        margin: 0 auto;
        cursor:pointer;
      }

    </style>                                       

    <style type="text/css" id="css_table">
      table {
        text-align: center;
        vertical-align: middle;
        margin: 0px auto;
        padding: 0px;
        white-space: nowrap !important;
      }
    </style>

    <style id="css_progress">
      #pagedeck {
        overflow: hidden !important;
      }
      div.progress {
        margin: auto;
        padding: 0px;
        width: 20%;
        height: 1.25rem;
        background-color: rgb(238, 238, 255);
        border: 0.125rem solid black;
      }
      div.progressIndicator {
        margin: 0px;
        padding: 0px;
        background-color: turquoise;
        position: relative;
        top: 0px;
        left: 0px;
        width: 10%;
        height: 100%;
      }
      div.progressVal {
        position: relative;
        top: -1.375rem;
        margin: 0px;
        padding: 0px;
        height: 1.25rem;
        text-align: center;
        font-weight: bold;
      }
      .hidden {
        top: -20rem;
        left: -200rem;
        position: absolute !important;
      }
      .focus {
        background-color: rgb(238, 238, 238) !important;
      }
    </style>

  </head>

  <body class="htmlNoPages">

    <div id="container_questionnaire" >
      <div id="container_Q1" class="questionnaire" style="">
        
        <div id="Q1" class="questionnaire">
          <div data-role="page" class="google form" id="SCALE" align="center">
            <form id="theme" name="theme" action="" method="POST" target="hidden_iframe">
              

                <div id="container_progressADJ" style="display: ;">
                  <div id="container_ADJ" class="ADJ">
                    <table id="table_ADJ_Range" class="Range" style="display: ; min-width: 32rem;" cellpadding="1px">
                      <tbody id="tbody_SDS">
                        
                      </tbody>
                    </table>
 
                  </div>

                  <div class="button">
                    <div id="button_Submit"><br>
                      <!--放分數的隱藏的表-->
                      <table id="table_ADJ_hidden" style="display: none;">
                        <tbody>
                          <tr id="tr_ADJ_hidden">
                          </tr>
                        </tbody>
                      </table>
                      <input id="submit_LV" type="submit" disabled="true" ontouchstart="submitForm();" value="提交" onclick="submitForm();"><br>

                    </div><br>

                  </div>
                </div>
              </div>

            </form>
            <div id="finish" style="display: none;">
              <span style="font-size: 5rem; line-height: 15rem;"><b>完成填寫</b></span><br>
            </div>
          </div>
        </div>
      </div>
      
      </div>
    </div>
  </body>
  <script type="text/javascript">
      
     $('#theme').submit(function(event) {
      event.preventDefault();
      setTimeout(function() {
        // Get data
        var data = {

          'entry.511407135': $('#ADJSCORE_1').val(),
          'entry.1152870785': $('#ADJSCORE_2').val(),
          'entry.1079921585': $('#ADJSCORE_3').val(),
          'entry.927862003': $('#ADJSCORE_4').val(),
          'entry.1883799580': $('#ADJSCORE_5').val(),
          'entry.1465052067': $('#ADJSCORE_6').val(),
          'entry.985700968': $('#ADJSCORE_7').val(),
          'entry.418613732': $('#ADJSCORE_8').val(),
          'entry.94031112': $('#ADJSCORE_9').val(),
          'entry.1120322361': $('#ADJSCORE_10').val(),
          'entry.156344772': $('#ADJSCORE_11').val(),
          'entry.1428082092': $('#ADJSCORE_12').val(),
          'entry.1292637192': $('#ADJSCORE_13').val(),
          'entry.423724387': $('#ADJSCORE_14').val(),
          'entry.1755300774': $('#ADJSCORE_15').val(),
          'entry.1164985306': $('#ADJSCORE_16').val(),
          'entry.1902800109': $('#ADJSCORE_17').val(),
          'entry.814714499': $('#ADJSCORE_18').val()
        };

        // Validate form
        var formSuccess = true;
        Object.keys(data).forEach(function(key, index) {
          if (!data[key]) {
            formSuccess = false;
          }
        });

        if (formSuccess) {
          // Send request
          $.ajax({
            url: document.theme.action,
            type: 'POST',
            crossDomain: true,
            dataType: "xml",
            data: data,
            success: function(jqXHR, textStatus, errorThrown) {
              console.log('Enter on success');
            },
            error: function(jqXHR, textStatus, errorThrown) {
              console.log('Enter on error');
            }
          });
        }
      }, 300);
    });


/*jquery UI Slider*/
$( function() {
    var tbody = document.getElementById("tbody_SDS");

    for(var i=1; i<=ADJ_Total; i++){

    var tr = document.createElement('tr');
    tr.id("tr_ADJ_"+i);
    tr.attr("style", "height:1.5rem");

    var td_Left = document.createElement('td');
    td_Left.attr("align", "right");

    var div_Left = document.createElement('div');
    div_Left.id = "div_ADJ_Left_" + i;
    div_Left.class = "ADJ_Word";
    div_Left.text(ADJ_Word[(i-1)*2]);

    var td_Right = document.createElement('td');
    td_Right.attr("align", "left");

    var div_Right = document.createElement('div');
    div_Right.id = "div_ADJ_Right_" + i;
    div_Right.class = "ADJ_Word";
    div_Right.text(ADJ_Word[(i-1)*2 + 1]);

    var td_Middle = document.createElement('td');
    td_Middle.attr("colspan", "5");
    td_Middle.attr("height", "100%");
    td_Middle.attr("style", "width:16rem");
    
    var div_container_slider = document.createElement('div');
    div_container_slider.class = "container_slider";
    var div_slider = document.createElement('div');
    div_slider.id = "slider_" + i;
    div_slider.class = "Range slider">
    div_slider.attr("style", "width:14rem");
    var div_handle = document.createElement('div');
    div_handle.id = "custom-handle_" + i;
    div_handle.class = "ui-slider-handle custom-handle">
    
    //append進去
    td_Left.appendChild(div_Left);
    td_Right.appendChild(div_Right);

    div_slider.appendChild(div_handle);
    div_container_slider.appendChild(div_slider);
    td_Middle.appendChild(div_container_slider);

    tr.appendChild(td_Left);
    tr.appendChild(td_Middle);
    tr.appendChild(td_Right);
    }

});

$( function() {
  $(".container_slider").each(function(index,element) {

  var track = $("#slider_"+(index+1), this);
  var handle =  $("#custom-handle_"+(index+1), this);

  track.slider({
    range:false,
    step: 0.1,
    min:0,
    max:100,
    create: function() {
      handle.css("background-size", "cover");
      handle.css("background-color", "transparent");
      handle.css("border", "0px black solid");
      handle.hide();
    },
    slide: function( event, ui ) {
      ADJ_i = index + 1;
      alert(ADJ_i);
      recordScore(Math.abs(ui.value));
      handle.css("background-image", "url('https://imgur.com/94YyvTo.png')");
      track.css("background","#777");
    }});
  track.hover(()=>{
    track.css("background","#777");
    handle.css("background-image", "url('https://imgur.com/94YyvTo.png')");
  },()=>{
    track.css("background","#ccc");
    handle.css("background-image", "url('https://imgur.com/06zVfHc.png')");});
  track.focus(()=>{
    track.css("background","#777");
    handle.css("background-image", "url('https://imgur.com/94YyvTo.png')");
  });
  track.blur(()=>{
    track.css("background","#ccc");
    handle.css("background-image", "url('https://imgur.com/06zVfHc.png')");});
  
	});
});

var ADJ_i = 1;
var ADJ_Total = 2;
var ADJ_Answered = 0;
var ADJ_Score = new Array();
var ADJ_Entry = ["QQ1", "QQ2"];
var ADJ_Word = [
  "小巧的","碩大的",
  "細紋路的","粗紋路的"];

function recordScore(score){
  ADJ_Score[ADJ_i - 1] = score;
  //document.getElementById('not yet').style.display = 'none';
  var input_exist = document.getElementById("ADJSCORE_" + ADJ_i);
  if(input_exist) input_exist.value = ADJ_Score[ADJ_i-1];
  else{
    var tr = document.getElementById("tr_ADJ_hidden");
    var td = document.createElement('td');
    var input = document.createElement('input');
    input.type = "hidden";
    input.id = "ADJSCORE_" + ADJ_i;
    input.name = ADJ_Entry[ADJ_i-1];
    input.value = ADJ_Score[ADJ_i-1];
    td.appendChild(input);
    tr.appendChild(td);
    ADJ_Answered++;
  }
  setCrossPosition();
  if (ADJ_Answered == ADJ_Total) document.getElementById('submit_LV').disabled = false;
}

function setCrossPosition(){
    /*by jQuery UI*/
    $( "#slider_" + ADJ_i ).slider("value",ADJ_Score[ADJ_i-1]);
    $( "#custom-handle_" + ADJ_i ).show();  
    alert(ADJ_Score[ADJ_i-1]);
  
}


  </script>
</html>