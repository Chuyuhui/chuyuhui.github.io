<!DOCTYPE html>
<html><head>

  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><meta charset="utf-8">
  <title>形容詞感受量表（VAS）</title>
  <style type="text/css">
    p {
      margin: 0px;
    }
    h1 {
      margin: 0px;
    }
    h2 {
      margin: 0px;
    }
    h3 {
      margin: 0px;
    }
    html,
    body {
      width: 100%;
      height: 100%;
      margin: 0px;
    }
    body {

      background-color: transparent;
      transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
      -webkit-transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
      -moz-transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
      perspective: 1400px;
      -webkit-perspective: 1400px;
      -moz-perspective: 1400px;
      transform-style: preserve-3d;
      -webkit-transform-style: preserve-3d;
      -moz-transform-style: preserve-3d;
    }
    div {
      width:100%;
      //height:100%;
    }

    #pagedeck { overflow: hidden !important; }

    div.progress {
      margin: auto;
      padding: 0;
      width: 20%;
      height: 20px;
      background-color: #eef;
      border: 2px solid black;
    }

    div.progressIndicator {
      margin: 0;
      padding: 0;
      background-color: turquoise;
      position: relative;
      top: 0;
      left: 0px;
      width: 10%;
      height: 100%;
    }

    div.progressVal  {
      position: relative;
      top: -22px;
      margin: 0;
      padding: 0;
      height: 20px;
      text-align: center;
      font-weight: bold;
    }

    .hidden {
      position: absolute !important;
      top: -20em;
      left: -200em;
    }

    .focus {
      background-color: #eee !important;
    }
  </style>


  <style type="text/css">#pagedeck { overflow: hidden !important; }</style></head>

  <body>
    <style type="text/css">

      table {
        text-align:center;
      }

    </style>
    <style id="css"></style>


    <div data-role="page" class="google form" id="whole" align="center" style="font-family:Microsoft JhengHei;font-size:100%">


      <form action="https://docs.google.com/forms/u/1/d/e/1FAIpQLScfnUmskVkWPsCKNqlDfQuV5yp2bmUtVAVMJxOUKaij5vOZkQ/formResponse" method="post">
        <div id="part_Name_Stage_Sample" name="part_Name_Stage_Sample" ><br>
          參與者編號：
          <input id="participant" type="text" name="entry.726136822" onchange="closeNoText()"><br>
          <br>
          體驗階段　：
          <input id="stage" type="text" name="entry.1175304058" onchange="closeNoText()"><br>
          <br>
          樣本編號　：
          <input id="sample" type="text" name="entry.972880170" onchange="closeNoText()"><br>
          <br>
          <div id="no text" style="display:none;color:red;">
            <b>尚有欄位未填</b><br><br>
          </div>
          <button type="button" style="font-family:Microsoft JhengHei;" onclick="javascript:showVAS();" ontouchstart="javascript: showVAS();">繼續</button>
        </div>

        <div id="part_ADJ" style="display:none;"><br>
          本問卷共有20組左右相反的形容詞。<br>
          <br>
          在每組形容詞中，<br>
          越 <b>中間</b> 代表對於兩邊的形容詞 <b>都沒有明顯的感受</b> ，<br>
          越往 <b>兩端</b> 則代表該感受越為 <b>強烈</b> 。<br><br>
          <p id="explanation">
            <img src="https://imgur.com/0JQRGFU.png" width="40%"><br>
            請您在與滑鼠互動後，<br>
            依序針對每組形容詞評價您所感受到的意象。<br><br><br>
          </p>

          <div id="example" class="pic">
            <b>---以下為填寫範例---</b><br><br>
            若您認為它 <b style="color:red;">不偏向</b> 華麗或樸素，感受處於中立，請點擊 <b>中間</b> 的一格。<br><br>
            <img src="https://imgur.com/dFMh4LZ.png" width="40%"><br><br>

            若您認為它 <b style="color:red;">非常樸素</b>，請根據點擊 <b>最右方</b> 的一格。（越靠近「樸素的」代表程度越 <b>大</b>）<br><br>
            <img src="https://imgur.com/UVuuHD7.png" width="40%"><br><br>

            若您認為它 <b style="color:red;">有點華麗</b>，請根據點擊 <b>中間偏左</b> 的一格。（越靠近中央代表程度越 <b>小</b>）<br><br>
            <img src="https://imgur.com/vhS0iy1.png" width="40%"><br><br>
            <button type="button" style="font-family:Microsoft JhengHei;" onclick="javascript:startAnswer();" ontouchstart="javascript: startAnswer();">開始填答</button><br><br>
          </div>

          <div id="container_progress&ADJ" style="display:none;">

            <div id="container_ADJ" class="ADJ" >

 	         <table id="table_ADJ">
                  <tr>
                  <th>　　　　　　　　</th>
                  <th>非常強烈</th>
                  <th>　　　　</th>
                  <th>不偏向<br>任何一邊</th>
                  <th>　　　　</th>
                  <th>非常強烈</th>
                  <th>　　　　　　　　</th>
                </tr>
                <tr id="tr_ADJ">
                  <td id="td_left" align="right">小巧的</td>
                  <td><input type="radio" name="entry.511407135" id="ADJ_RadioButton_1" value="5" required onchange="recordScore(this.value)"></td>
                  <td><input type="radio" name="entry.511407135" id="ADJ_RadioButton_2" value="4" onchange="recordScore(this.value)"></td>
                  <td><input type="radio" name="entry.511407135" id="ADJ_RadioButton_3" value="3" onchange="recordScore(this.value)"></td>
                  <td><input type="radio" name="entry.511407135" id="ADJ_RadioButton_4" value="2" onchange="recordScore(this.value)"></td>
                  <td><input type="radio" name="entry.511407135" id="ADJ_RadioButton_5" value="1" onchange="recordScore(this.value)"></td>
                  <td id="td_right" align="left">碩大的</td>
                </tr>
              </table>
            </div>

            <div id="not yet" style="display:none;color:red;">
              <b>尚未評價此形容詞</b>
            </div>

            <div class="button">
              <br>
              <div id="button_Back_Next" style="position:relative;vertical-align: middle;">
		<span style="font-family:Microsoft JhengHei;">---填寫進度---</span><br>
			<table>
<tr>
                <td><input class="back" id="back" type="button" value="Back <<" onclick="buttonBackADJ();" style="font-family:Microsoft JhengHei;" disabled="true"></td>
                <td><div id="pb1" class="progress" role="progressbar"   style="width:150px;" aria-labelledby="pb1_label" aria-valuenow="0" aria-valuemin="0" aria-valuemax="20" tabindex="0" align="left"></div></td>  
            	<td><input class="next" id="next" type="button" value="Next >>" onclick="buttonNextADJ();" style="font-family:Microsoft JhengHei;"></td>
</tr>
			</table>
              </div>
              <br>
              <div id="button_Submit" style="display:none;">
                <input id="submit" type="submit" disabled="true" style="font-family:Microsoft JhengHei;" value="提交">
              </div>
            </div>

          </div>

        </div>

        <!--放分數的隱藏的表-->
        <table id="table_ADJ_hidden" style="display:none;">
          <tr id="tr_ADJ_hidden">
          </tr>
        </table>

      </form>
    </div>

  </body></html>


<script language="JavaScript" type="text/javascript">
  var ADJ_i = 1;
  var ADJ_Score = new Array();
  var ADJ_Word = [
    "小巧的","碩大的",
    "細紋路的","粗紋路的",
    "簡約的","複雜的",
    "低噪的","非低噪的",
    "有回饋的","無回饋的",
    "回饋聲音清晰的","回饋聲音不清晰的",
    "便攜的","不便攜的",
    "手感明確的","手感不明確的",
    "好按的","不好按的",
    "輕鬆掌握的","無法輕鬆掌握的",
    "舒適的","不舒適的",
    "堅固的","不堅固的",
    "輕薄的","厚重的",
    "符合人體工學的","不符合人體工學的",
    "包覆性的","非包覆性的",
    "耐髒的","不耐髒的",
    "靈敏的","不靈敏的",
    "精準的","不精準的",
    "滿意的","不滿意的",
    "想購買的","不想購買的"];

  var ADJ_Entry = [
    "entry.511407135",
    "entry.1152870785",
    "entry.1079921585",
    "entry.927862003",
    "entry.1883799580",
    "entry.1465052067",
    "entry.985700968",
    "entry.418613732",
    "entry.94031112",
    "entry.1120322361",
    "entry.156344772",
    "entry.1428082092",
    "entry.1292637192",
    "entry.423724387",
    "entry.1755300774",
    "entry.1164985306",
    "entry.1902800109",
    "entry.814714499",
    "entry.202069723",
    "entry.31311220"];


  function recordScore(score){
    ADJ_Score[ADJ_i - 1] = score;
    document.getElementById('not yet').style.display = 'none';
    if (ADJ_i == 20) document.getElementById('submit').disabled = false;

    var input_exist = document.getElementById("ADJSCORE_" + ADJ_i);
    if(input_exist) input_exist.value = ADJ_Score[ADJ_i-1];
    else{
      var tr = document.getElementById("tr_ADJ_hidden");
      var td = document.createElement('td');
      var input = document.createElement('input');
      input.type = "hidden";
      input.id = "ADJSCORE_" + ADJ_i;
      input.name = ADJ_Entry[ADJ_i-1];
      input.value = ADJ_Score[ADJ_i-1];
      td.appendChild(input);
      tr.appendChild(td);
    }
  }

  function changeADJ(){

    document.getElementById("td_left").innerHTML = ADJ_Word[(ADJ_i-1)*2];
    document.getElementById("td_right").innerHTML = ADJ_Word[(ADJ_i-1)*2+1];

    for(i=1;i<=5;i++)
    {
      document.getElementById("ADJ_RadioButton_"+i).checked = false;
      document.getElementById("ADJ_RadioButton_"+i).setAttribute("name",ADJ_Entry[ADJ_i-1]);
      if(ADJ_Score[ADJ_i-1]){
        if((6-i) == ADJ_Score[ADJ_i-1]) document.getElementById("ADJ_RadioButton_" + i).checked = true;
      }
    }
  }


  function showVAS() {
    var participant = document.getElementById('participant').value;
    var stage = document.getElementById('stage').value;
    var sample = document.getElementById('sample').value;
    if(!participant || !stage || !sample){
      document.getElementById('no text').style.display = '';
    }
    else{
      document.getElementById('no text').style.display = 'none'; 
      document.getElementById('part_Name_Stage_Sample').style.display = 'none';
      document.getElementById('part_ADJ').style.display = '';
    }
  }

  function closeNoText(){
    document.getElementById('no text').style.display = 'none'; 
  }


  function startAnswer() {
    document.getElementById('explanation').style.display = 'none';
    document.getElementById('example').style.display = 'none';
    document.getElementById('container_progress&ADJ').style.display = '';
  }



  // Users want to proceed after doing the scales
  function buttonNextADJ() {
    if(!ADJ_Score[ADJ_i - 1]) document.getElementById('not yet').style.display = '';
    else{
      document.getElementById('back').disabled = false;
      document.getElementById('next').disabled = false;
      document.getElementById('not yet').style.display = 'none';
      ADJ_i += 1;
      changeADJ();
      doForwards();
      if (ADJ_i == 20){
        document.getElementById('next').disabled = true;
        document.getElementById('button_Submit').style.display = '';
      }
    }
    return true;
  }

  function buttonBackADJ() {

    document.getElementById('back').disabled = false;
    document.getElementById('next').disabled = false;
    document.getElementById('not yet').style.display = 'none';
    ADJ_i -= 1;
    changeADJ();
    doBackwards();
    if (ADJ_i == 1) document.getElementById('back').disabled = true;
    return true;
  }


  function DetectIsIE() {
    var ua = window.navigator.userAgent;

    var msie = ua.indexOf('MSIE ');
    if (msie > 0) {
      // 回傳版本 <=10 的版本
      return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
    }

    var trident = ua.indexOf('Trident/');
    if (trident > 0) {
      // 回傳版本 >=11 的版本
      var rv = ua.indexOf('rv:');
      return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
    }

    var edge = ua.indexOf('Edge/');
    if (edge > 0) {
      // 判斷Edge
      return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);
    }

    // other browser
    return false;
  }

  var isIE = DetectIsIE();

  /*
    var q = DetectIsIE();
    if (q != false) {
      alert('是IE');
      //window.location = 'http://google.com';
      }
    else {
      alert('不是IE');
    }
    */

  function showThumb(range_id){
    var css = document.getElementById('css');
    var range = document.getElementById(range_id);
    var c = css.sheet;
    if(isIE) c.insertRule("#"+range_id+"#"+range_id+"::-ms-thumb {visibility:visible;}", 0);
    else{
      c.insertRule("#"+range_id+"#"+range_id+"::-webkit-slider-thumb {visibility:visible;}", 0);
      c.insertRule("#"+range_id+"#"+range_id+"::-moz-range-thumb {visibility:visible;}", 0);
    }
  }

</script>

<script language="JavaScript" type="text/javascript">
  var g_progress1 = null;
  var g_$startButton = null;

  var g_intervalID = null; // the handle of the interval set when the example is running
  var g_curVal = 0;
  var g_maxVal = 20;

  // function increment() increments the value and passes the new value to the progress bar
  // widget. If the progress bar is at 100%, it stops the increment.
  //
  function doForwards () {

    if (g_progress1.getProgress() == 100) {
      //clearInterval(g_intervalID);
      //g_intervalID = null;

      // make sure that the progress bar shows that it is full
      g_progress1.$progDiv.css('width', '100%');

      g_curVal = 0;
      //g_$startButton.html('Reset Example');
      return;
    }

    g_curVal = g_curVal + g_maxVal/20;
    g_progress1.setValue(g_curVal);
  }

  function doBackwards () {

    if (g_progress1.getProgress() == 100) {
      //clearInterval(g_intervalID);
      //g_intervalID = null;

      // make sure that the progress bar shows that it is full
      g_progress1.$progDiv.css('width', '100%');

      g_curVal = 0;
      //g_$startButton.html('Reset Example');
      return;
    }

    g_curVal = g_curVal - g_maxVal/20;
    g_progress1.setValue(g_curVal);
  }

  $(document).ready(function() {

    var running = false; // true if example is running

    // progress1 is a progress bar
    g_progress1 = new progressbar('pb1', g_maxVal, true);

    g_$startButton = $('#pb1_control');

    // bind a click handler to the start  button
    g_$startButton.click(function(e) {

      if (g_progress1.getProgress() == 100) {
        g_progress1.setValue(0);
      }

      if (running == true) {
        //clearInterval(g_intervalID);
        //g_intervalID = null;
        //g_$startButton.html('Start Example');
        running = false;
      }
      else {
        // create an interval timer to increment the count every second

        //g_intervalID = setInterval("doUpdate()", 100);
        doUpdate();
        //g_$startButton.html('Stop Example');

        running = true;
      }
    });

  }); // end document ready



  ////////////////////////////////////////////////////
  //
  // function progressbar() is a class to define an ARIA-enabled progressbar widget.
  //
  // @param(container_id string) container_id is the containing div for the progressbar
  //
  // @param(max integer) max is the maximum value for the values being set. Used to calculate percent progress
  //
  // @param(showVal boolean) showVal is true if the current progress value should be shown
  //
  // @return N/A
  //
  function progressbar(container_id, max, showVal) {

    // define progressbar object properties

    this.$container = $('#' + container_id);
    this.valMax = max;
    this.showVal = showVal;
    this.divWidth = 0;

    // Store the size of the progress bar
    this.width = this.$container.width();

    // Store the page position of the widget
    this.left = Math.round(this.$container.offset().left);
    this.top = Math.round(this.$container.offset().top);

    // Create and initialize the progress indicator
    this.$container.append('<div id="progDiv" class="progressIndicator" ></div>');
    this.$progDiv = $('#progDiv');
    this.$progDiv.css('width', '5%');

    // Create and initialize the value box
    this.$container.append('<div id="progVal" class="progressVal" aria-hidden="false"></div>');
    this.$progVal = $('#progVal');
    this.$progVal.html('1/20');

    if (this.showVal == false) {
      this.$progVal.addClass('hidden').attr('aria-hidden', 'true');
    }

  } // end progressbar constructor

  //
  // function setValue() is a member function to set the value of the progress bar.
  //
  // @param(val integer) val is the new value to calculate the progress from
  //
  // @return N/A
  //
  progressbar.prototype.setValue = function(val)  {

    var percent = val * 100 / this.valMax;

    if (percent <= 100.0) {
      this.$container.attr('aria-valuenow', Math.round(percent));
      this.$progDiv.css('width', percent+5 + '%'); //Math.round(percent) + '%');
      this.$progVal.html((this.$container.attr('aria-valuenow')/5+1) + '/20');
    }
  }

  //
  // function getProgress() is a member function to return the percent progress
  //
  // @return (integer) Returns the percent progress in integer form (e.g. 50 represents 50%)
  //
  progressbar.prototype.getProgress = function()  {

    return this.$container.attr('aria-valuenow');
  }

  //
  // function positionHandle() is a member function to position a handle at the specified value for the
  // progressbar. If showVal is true, it also positions and updates the displayed value container.
  //
  // @param($handle object) $handle is a pointer to the handle jQuery object to manipulate
  //
  // @param (val integer) val is the new value of the progressbar
  //
  // @return N/A
  //
  progressbar.prototype.positionHandle = function($handle, val) {

    var handleHeight = $handle.outerHeight(); // the total height of the handle
    var handleWidth = $handle.outerWidth(); // the total width of the handle
    var handleOffset; // the distance from the value position for centering the handle
    var xPos; // calculated horizontal position of the handle;
    var yPos; // calculated vertical position of the handle;
    var valPos; //calculated new pixel position for the value;


    // calculate the horizontal pixel position of the specified value
    valPos = ((val - this.min) / (this.max - this.min)) * this.width + this.left;

    xPos = Math.round(valPos - (handleWidth / 2));
    yPos = Math.round(this.top + (this.height / 2) - (handleHeight / 2));

    // Set the position of the handle
    $handle.css('top', yPos + 'px');
    $handle.css('left', xPos + 'px');

    // Set the aria-valuenow position of the handle
    $handle.attr('aria-valuenow', val);

    // Update the stored handle values
    if (/1$/.test($handle.attr('id')) == true) {
      // first handle
      this.val1 = val;
    }
    else {
      // second handle
      this.val2 = val;
    }

    // if showVal is true, update the value container
    if (this.showVals == true) {
      this.updateValBox($handle, Math.round(valPos));
    }

  } // end positionHandle()

  //
  // function updateValBox() is a member function to reposition a handle value box and update its contents
  //
  // @return N/A
  //
  progressbar.prototype.updateValBox = function() {

    var $valBox = $('#' + $handle.attr('id') + '_val');

    var xPos; // horizontal pixel position of the box
    var yPos; // vertical pixel position of the box

    // Set the position of the handle
    var boxWidth = $valBox.outerWidth();

    yPos = $handle.css('top');

    // Adjust the horizontal position to center the value box on the value position
    xPos = Math.round(valPos - (boxWidth / 2)) + 'px';

    // Set the position of the value box
    $valBox.css('top', yPos);
    $valBox.css('left', xPos);

    // Set the text in the box to the handle value
    $valBox.text($handle.attr('aria-valuenow'));

  } // end updateValBox()

</script>



