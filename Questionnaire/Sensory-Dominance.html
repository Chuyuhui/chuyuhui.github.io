<!DOCTYPE html>
<html><head>

  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdn.rangetouch.com/2.0.1/rangetouch.js"></script>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><meta charset="utf-8">
  <title>形容詞感受量表（VAS/5-point Likert Scale）</title>
  
  <style type="text/css" id="css_Base">
    p {
      margin: 0px;
    }
    h1 {
      margin: 0px;
    }
    h2 {
      margin: 0px;
    }
    h3 {
      margin: 0px;
    }
    html,
    body {
      width: 100%;
      height: 100%;
      margin: 0px;
      font-size:16px;
      font-family:Microsoft JhengHei;
    }
    body {

      background-color: transparent;
      transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
      -webkit-transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
      -moz-transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
      perspective: 1400px;
      -webkit-perspective: 1400px;
      -moz-perspective: 1400px;
      transform-style: preserve-3d;
      -webkit-transform-style: preserve-3d;
      -moz-transform-style: preserve-3d;
    }
    div {
      width:100%;
      //height:100%;
    }

    #pagedeck { overflow: hidden !important; }

    div.progress {
      margin: auto;
      padding: 0;
      width: 20%;
      height: 20px;
      background-color: #eef;
      border: 2px solid black;
    }

    div.progressIndicator {
      margin: 0;
      padding: 0;
      background-color: turquoise;
      position: relative;
      top: 0;
      left: 0px;
      width: 10%;
      height: 100%;
    }

    div.progressVal  {
      position: relative;
      top: -22px;
      margin: 0;
      padding: 0;
      height: 20px;
      text-align: center;
      font-weight: bold;
    }

    .hidden {
      position: absolute !important;
      top: -20rem;
      left: -200rem;
    }

    .focus {
      background-color: #eee !important;
    }
  </style>
  
  <style type="text/css" id="css_RadioButton">
    input[type="radio"]{
      width:16px;
      height:16px;
      margin: 0px;
      vertical-align:middle;
    }
  </style>
  
  <style type="text/css" id="css_AnsButton">

    .AnsButton {
      background-color: #e7e7e7;
      border: none;
      color: black;
      padding: 15px 32px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      font-family:Microsoft JhengHei;
      font-weight: bold;
}

  </style>

  <style type="text/css" id="css"></style>
  </head>

  <body>

    <div data-role="page" class="google form" id="whole" align="center">
      <form name="theme" action="https://docs.google.com/forms/u/1/d/e/1FAIpQLSdDiacZzjfT32Tw5ArGH5FFLyokBbSTcUbgEaEkltSVdh1ncg/formResponse" method="post">
        <div id="part_Name_Stage"><br>
          參與者編號：
          <input id="participant" type="text" name="entry.1986078417" onchange="closeNoText()"><br>
          <br>
          體驗階段　：
          <input id="stage" type="text" name="entry.1079793000" onchange="closeNoText()"><br>
          <br>
          <div id="no text" style="display:none;color:red;">
            <b>尚有欄位未填</b><br><br>
          </div>
          <button type="button" style="font-family:Microsoft JhengHei;" onclick="javascript:showScale();" ontouchstart="javascript: showScale();">繼續</button>
        </div>

        <div id="part_Choose" style="display:none;"><br>
          本問卷旨在了解不同體驗階段時，<br>
          哪種感官感受是影響您評價的 <b>主要</b> 參考依據。<br><br>
          請問您認為在 <b>這個階段</b> 與滑鼠互動後所產生的感受，<br>
          主要是來自於何種 <b>感官</b> 接收到的刺激呢？<br><br>
          
          <div id="explanation">
            <b>————————————範例————————————</b><br><br>
            若您在可以<b>看見</b>、<b>聽見</b>、<b>觸摸</b>「頭戴式耳機」的情況下，<br>
            主要以它的「<b>跟耳朵接觸的部分</b>」進行感受評價，<br>
            「<b>聽起來的感覺</b>」次之，則在觸覺與聽覺之中選擇「<b>觸覺</b>」：<br><br>
<!--
            <b>*問題：</b>請問您剛才回答時，主要是依據何種感官刺激？<br>
            ○ 觸覺<br>
            ○ 聽覺<br><br>
-->
            <img src="https://imgur.com/pC74pKe.png" style="width:24rem;"><br>
            看到上述問題時，選擇 <b style="color:red;">觸覺</b> 即可。<br><br><br>

            如您評價時受到「<b>音質</b>」影響較大，「<b>外觀</b>」影響較小，則填答下方問題<br><br>
<!--
            <b>*問題：</b>請問您剛才回答時，主要是依據何種感官刺激？<br>
            ○ 視覺<br>
            ○ 聽覺<br><br>
-->
            <img src="https://imgur.com/77UEoDc.png" style="width:24rem;"><br>
            時，選擇 <b style="color:red;">聽覺</b> 即可。<br><br>

            如無其他問題，請按下方按鍵開始填答。<br><br>

            <div id="start">
              <button type="button" style="font-family:Microsoft JhengHei;" onclick="startAnswer();" ontouchstart="startAnswer();">開始填答</button><br><br>
            </div>

          </div>

          <div id="container_progress&Radio" style="display:none;">
            <div id="Q1" style="">
<!--
              <input type="radio" name="entry.727990184" id="RadioButton_1_V" value="視覺" onchange="recordScore(this.value,this.name,this.id);" required>
              <label>視覺</label><br><br>
              <input type="radio" name="entry.727990184" id="RadioButton_1_T" value="觸覺" onchange="recordScore(this.value,this.name,this.id);">
              <label>觸覺</label><br><br>
-->
              <input type="button" name="entry.727990184" id="Button_1_V" value="視覺" class="AnsButton Q1Button" onclick="recordScore(this.value,this.name,this.id);" ontouchstart="recordScore(this.value,this.name,this.id);">&emsp;&emsp;
              <input type="button" name="entry.727990184" id="Button_1_T" value="觸覺" class="AnsButton Q1Button" onclick="recordScore(this.value,this.name,this.id);" ontouchstart="recordScore(this.value,this.name,this.id);">
            </div>
            
            <div id="Q2" style="display:none;">
              <!--
              <input type="radio" name="entry.2073835214" id="RadioButton_2_V" value="視覺" onchange="recordScore(this.value,this.name,this.id);" required>
              <label>視覺</label><br><br>
              <input type="radio" name="entry.2073835214" id="RadioButton_2_A" value="聽覺" onchange="recordScore(this.value,this.name,this.id);">
              <label>聽覺</label><br><br>
              -->
              <input type="button" name="entry.2073835214" id="Button_2_V" value="視覺" class="AnsButton Q2Button" onclick="recordScore(this.value,this.name,this.id);" ontouchstart="recordScore(this.value,this.name,this.id);">&emsp;&emsp;
              <input type="button" name="entry.2073835214" id="Button_2_A" value="聽覺" class="AnsButton Q2Button" onclick="recordScore(this.value,this.name,this.id);" ontouchstart="recordScore(this.value,this.name,this.id);">
            </div>
            
            <div id="Q3" style="display:none;">
              <!--
              <input type="radio" name="entry.1677724600" id="RadioButton_3_T" value="觸覺" onchange="recordScore(this.value,this.name,this.id);" required>
              <label>觸覺</label><br><br>
              <input type="radio" name="entry.1677724600" id="RadioButton_3_A" value="聽覺" onchange="recordScore(this.value,this.name,this.id);">
              <label>聽覺</label><br><br>
              -->
              <input type="button" name="entry.1677724600" id="Button_3_T" value="觸覺" class="AnsButton Q3Button" onclick="recordScore(this.value,this.name,this.id);" ontouchstart="recordScore(this.value,this.name,this.id);">&emsp;&emsp;
              <input type="button" name="entry.1677724600" id="Button_3_A" value="聽覺" class="AnsButton Q3Button" onclick="recordScore(this.value,this.name,this.id);" ontouchstart="recordScore(this.value,this.name,this.id);">
            </div>
            <br>
            <div id="not yet" style="display:none;color:red;">
              <b>尚未答題</b>
            </div>

            <div class="button">
              <div id="button_Back_Next" style="position:relative;vertical-align: middle;">
                <span style="font-family:Microsoft JhengHei;">---填寫進度---</span><br>
                <table>
                  <tr>
                    <td><input class="back" id="back" type="button" value="<< 前一個" onclick="buttonBackQ();" style="font-family:Microsoft JhengHei;" disabled="true"></td>
                    <td><div id="pb1" class="progress" role="progressbar"   style="width:150px;" aria-labelledby="pb1_label" aria-valuenow="0" aria-valuemin="0" aria-valuemax="3" tabindex="0" align="left"></div></td>  
                    <td><input class="next" id="next" type="button" value="下一個 >>" onclick="buttonNextQ();" style="font-family:Microsoft JhengHei;"></td>
                  </tr>
                </table>
              </div>
              <br>
              <div id="button_Submit" style="display:none;">
                <input id="submit" type="submit" disabled="true" style="font-family:Microsoft JhengHei;"  onclick="submitForm();" ontouchstart="submitForm();" value="提交">
              </div>
            </div>

          </div>

        </div>

        <!--放分數的隱藏的表-->
        <table id="table_hidden" style="display:none;">
          <tr id="tr_hidden">
          </tr>
        </table>

      </form>
      
      <div id="finish" style="height:250px;display:none">
        <sapn style="font-size:5rem;line-height:250px;"><b>完成填寫</b></sapn>
      </div>
    </div>

  </body></html>

<script language="JavaScript" type="text/javascript">
  /*共用，不需調整*/
  function fillInData(isFilled, participant, stage){
    if(isFilled){
      document.getElementById('participant').value = participant;
      document.getElementById('stage').value = stage;
      showScale();
    }
  }
 
  function showScale() {
    var participant = document.getElementById('participant').value;
    var stage = document.getElementById('stage').value;
    if(!participant || !stage){
      document.getElementById('no text').style.display = '';
    }
    else{
      document.getElementById('no text').style.display = 'none'; 
      document.getElementById('part_Name_Stage').style.display = 'none';
      document.getElementById('part_Choose').style.display = '';
    }
  }

  function closeNoText(){
    document.getElementById('no text').style.display = 'none'; 
  }

  function startAnswer() {
    document.getElementById('explanation').style.display = 'none';
    document.getElementById('container_progress&Radio').style.display = '';
    /*測試寬度用
    alert($("#table_ADJ_Range").width());
    alert($("#table_ADJ_RadioButton").width())
    var bodyRect_B = document.body.getBoundingClientRect();
    var elemRect_B = document.getElementById("ADJ_RadioButton_1").getBoundingClientRect();
    var offset_B = elemRect_B.left - bodyRect_B.left;
    alert(offset_B);
    var bodyRect_R = document.body.getBoundingClientRect();
    var elemRect_R = document.getElementById("ADJ_Range").getBoundingClientRect();
    var offset_R   = elemRect_R.left - bodyRect_R.left;
    alert(offset_R);
    */
  }

  function DetectIsIE() {
    var ua = window.navigator.userAgent;

    var msie = ua.indexOf('MSIE ');
    if (msie > 0) {
      // 回傳版本 <=10 的版本
      return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
    }

    var trident = ua.indexOf('Trident/');
    if (trident > 0) {
      // 回傳版本 >=11 的版本
      var rv = ua.indexOf('rv:');
      return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
    }

    var edge = ua.indexOf('Edge/');
    if (edge > 0) {
      // 判斷Edge
      return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);
    }

    // other browser
    return false;
  }

  function detectBrowser(){

    var isFirefox = navigator.userAgent.search("Firefox") > -1;
    var isOpera = navigator.userAgent.search("Opera") > -1;
    var isSafari = navigator.userAgent.search("Safari") > -1;//Google瀏覽器是用這核心

    var isIE =  DetectIsIE();

    if (isFirefox) {
      browser = 'Firefox';
    }
    if (isOpera) {
      browser = 'Opera';
    }
    if (isSafari) {
      browser = 'Safari/Chrome';
    }
    if (isIE) {
      browser = 'IE';
    }
    return browser;
  }

  var browser = detectBrowser();

  /*
  var size = $("div").css('font-size');
  alert(size);
  var tdwidth = $("#td_middle").width();
  alert(tdwidth);
  */
  var Ans_i = 1;
  var Ans_Array = new Array();
  function recordScore(Ans,name,id){
    Ans_Array[Ans_i - 1] = Ans;
    var Buttons = document.getElementsByName(name);
    for(i=0;i<Buttons.length;i++){
      Buttons[i].style.backgroundColor = "#e7e7e7";
      Buttons[i].style.color = "black";
    }
    document.getElementById(id).style.backgroundColor = "turquoise";
    document.getElementById('not yet').style.display = 'none';
    if (Ans_i == 3) document.getElementById('submit').disabled = false;
    var input_exist = document.getElementById("Ans_" + Ans_i);
    if(input_exist) input_exist.value = Ans_Array[Ans_i - 1];
    else{
      var tr = document.getElementById("tr_hidden");
      var td = document.createElement('td');
      var input = document.createElement('input');
      input.type = "hidden";
      input.id = "Ans_" + Ans_i;
      input.name = name;
      input.value = Ans_Array[Ans_i - 1];
      td.appendChild(input);
      tr.appendChild(td);
    }
    /*
     var c = document.getElementById('css').sheet;
     if(c.cssRules.length > 0) c.deleteRule(0);
     if(browser=='IE') c.insertRule("#ADJ_Range#ADJ_Range::-ms-thumb {visibility:visible;}", 0);
     else if(browser=='Safari/Chrome') c.insertRule("#ADJ_Range#ADJ_Range::-webkit-slider-thumb {visibility:visible;}", 0);
     else if(browser=='Firefox') c.insertRule("#ADJ_Range#ADJ_Range::-moz-range-thumb {visibility:visible;}", 0);
     */
  }
  function buttonNextQ() {
    if(!Ans_Array[Ans_i - 1]) document.getElementById('not yet').style.display = '';
    else{
      document.getElementById('back').disabled = false;
      document.getElementById('next').disabled = false;
      document.getElementById('not yet').style.display = 'none';
      document.getElementById("Q"+Ans_i).style.display='none';
    Ans_i += 1;
    document.getElementById("Q"+Ans_i).style.display='';
      doForwards();
      if (Ans_i == 3){
        document.getElementById('next').disabled = true;
        document.getElementById('button_Submit').style.display = '';
      }
    }
    return true;
  }
  function buttonBackQ() {
    document.getElementById('back').disabled = false;
    document.getElementById('next').disabled = false;
    document.getElementById('not yet').style.display = 'none';
    document.getElementById("Q"+Ans_i).style.display='none';
    Ans_i -= 1;
    document.getElementById("Q"+Ans_i).style.display='';
    doBackwards();
    if (Ans_i == 1) document.getElementById('back').disabled = true;
    return true;
  }
  function submitForm(){
    document.getElementById("part_Choose").style.display='none';
    document.getElementById("finish").style.display='';
    document.getElementByName('theme').submit();
  }


  
  /*進度條*/
  var g_progress1 = null;
  var g_$startButton = null;
  var g_intervalID = null; // the handle of the interval set when the example is running
  var g_curVal = 0;
  var g_maxVal = 3;

  // function increment() increments the value and passes the new value to the progress bar
  // widget. If the progress bar is at 100%, it stops the increment.
  //
  function doForwards () {

    if (g_progress1.getProgress() == 100) {
      //clearInterval(g_intervalID);
      //g_intervalID = null;

      // make sure that the progress bar shows that it is full
      g_progress1.$progDiv.css('width', '100%');

      g_curVal = 0;
      //g_$startButton.html('Reset Example');
      return;
    }

    g_curVal = g_curVal + g_maxVal/3;
    g_progress1.setValue(g_curVal);
  }

  function doBackwards () {

    if (g_progress1.getProgress() == 100) {
      //clearInterval(g_intervalID);
      //g_intervalID = null;

      // make sure that the progress bar shows that it is full
      g_progress1.$progDiv.css('width', '100%');

      g_curVal = 0;
      //g_$startButton.html('Reset Example');
      return;
    }

    g_curVal = g_curVal - g_maxVal/3;
    g_progress1.setValue(g_curVal);
  }

  $(document).ready(function() {

    var running = false; // true if example is running

    // progress1 is a progress bar
    g_progress1 = new progressbar('pb1', g_maxVal, true);

    g_$startButton = $('#pb1_control');

    // bind a click handler to the start  button
    g_$startButton.click(function(e) {

      if (g_progress1.getProgress() == 100) {
        g_progress1.setValue(0);
      }

      if (running == true) {
        //clearInterval(g_intervalID);
        //g_intervalID = null;
        //g_$startButton.html('Start Example');
        running = false;
      }
      else {
        // create an interval timer to increment the count every second

        //g_intervalID = setInterval("doUpdate()", 100);
        doUpdate();
        //g_$startButton.html('Stop Example');

        running = true;
      }
    });

  }); // end document ready

  ////////////////////////////////////////////////////
  //
  // function progressbar() is a class to define an ARIA-enabled progressbar widget.
  //
  // @param(container_id string) container_id is the containing div for the progressbar
  //
  // @param(max integer) max is the maximum value for the values being set. Used to calculate percent progress
  //
  // @param(showVal boolean) showVal is true if the current progress value should be shown
  //
  // @return N/A
  //
  function progressbar(container_id, max, showVal) {

    // define progressbar object properties

    this.$container = $('#' + container_id);
    this.valMax = max;
    this.showVal = showVal;
    this.divWidth = 0;

    // Store the size of the progress bar
    this.width = this.$container.width();

    // Store the page position of the widget
    this.left = Math.round(this.$container.offset().left);
    this.top = Math.round(this.$container.offset().top);

    // Create and initialize the progress indicator
    this.$container.append('<div id="progDiv" class="progressIndicator" ></div>');
    this.$progDiv = $('#progDiv');
    this.$progDiv.css('width', '33.3%');

    // Create and initialize the value box
    this.$container.append('<div id="progVal" class="progressVal" aria-hidden="false"></div>');
    this.$progVal = $('#progVal');
    this.$progVal.html('1/3');

    if (this.showVal == false) {
      this.$progVal.addClass('hidden').attr('aria-hidden', 'true');
    }

  } // end progressbar constructor

  //
  // function setValue() is a member function to set the value of the progress bar.
  //
  // @param(val integer) val is the new value to calculate the progress from
  //
  // @return N/A
  //
  progressbar.prototype.setValue = function(val)  {

    var percent = val * 100 / this.valMax;
    if(percent <= 100.0) {
      this.$container.attr('aria-valuenow', Math.round(percent));
      this.$progDiv.css('width', (percent + 100/3) + '%'); //Math.round(percent) + '%');
      this.$progVal.html((Math.round(this.$container.attr('aria-valuenow')/33.33)+1) + '/3');
    }
  }

  //
  // function getProgress() is a member function to return the percent progress
  //
  // @return (integer) Returns the percent progress in integer form (e.g. 50 represents 50%)
  //
  progressbar.prototype.getProgress = function()  {

    return this.$container.attr('aria-valuenow');
  }

  //
  // function positionHandle() is a member function to position a handle at the specified value for the
  // progressbar. If showVal is true, it also positions and updates the displayed value container.
  //
  // @param($handle object) $handle is a pointer to the handle jQuery object to manipulate
  //
  // @param (val integer) val is the new value of the progressbar
  //
  // @return N/A
  //
  progressbar.prototype.positionHandle = function($handle, val) {

    var handleHeight = $handle.outerHeight(); // the total height of the handle
    var handleWidth = $handle.outerWidth(); // the total width of the handle
    var handleOffset; // the distance from the value position for centering the handle
    var xPos; // calculated horizontal position of the handle;
    var yPos; // calculated vertical position of the handle;
    var valPos; //calculated new pixel position for the value;


    // calculate the horizontal pixel position of the specified value
    valPos = ((val - this.min) / (this.max - this.min)) * this.width + this.left;

    xPos = Math.round(valPos - (handleWidth / 2));
    yPos = Math.round(this.top + (this.height / 2) - (handleHeight / 2));

    // Set the position of the handle
    $handle.css('top', yPos + 'px');
    $handle.css('left', xPos + 'px');

    // Set the aria-valuenow position of the handle
    $handle.attr('aria-valuenow', val);

    // Update the stored handle values
    if (/1$/.test($handle.attr('id')) == true) {
      // first handle
      this.val1 = val;
    }
    else {
      // second handle
      this.val2 = val;
    }

    // if showVal is true, update the value container
    if (this.showVals == true) {
      this.updateValBox($handle, Math.round(valPos));
    }

  } // end positionHandle()

  //
  // function updateValBox() is a member function to reposition a handle value box and update its contents
  //
  // @return N/A
  //
  progressbar.prototype.updateValBox = function() {

    var $valBox = $('#' + $handle.attr('id') + '_val');

    var xPos; // horizontal pixel position of the box
    var yPos; // vertical pixel position of the box

    // Set the position of the handle
    var boxWidth = $valBox.outerWidth();

    yPos = $handle.css('top');

    // Adjust the horizontal position to center the value box on the value position
    xPos = Math.round(valPos - (boxWidth / 2)) + 'px';

    // Set the position of the value box
    $valBox.css('top', yPos);
    $valBox.css('left', xPos);

    // Set the text in the box to the handle value
    $valBox.text($handle.attr('aria-valuenow'));

  } // end updateValBox()

  //順序：isFilled, participant, stage
  //isFilled是要不要填，true代表我先輸好
  //scale有Range和RadioButton
  
  //fillInData(true,1,1);
</script>